function Controller(){function e(){var e=!1,i=new Date,t=new Date;if(t=new Date(r.year_picker.getSelectedRow(0).title,r.month_picker.getSelectedRow(0).value,r.day_picker.getSelectedRow(0).title,0,0,0,0),Ti.API.info("birth date: "+t.toString()),i.getFullYear()-t.getFullYear()>18)e=!0;else if(18==i.getFullYear()-t.getFullYear()){var o=i.getMonth(),a=t.getMonth();if(o>a)e=!0;else if(o==a){var i=i.getDate(),t=t.getDate();i>=t&&(e=!0)}}e?(Ti.App.Properties.setBool("over18",!0),Alloy.Globals.parent.open(),r.age_gate.close()):alert("You must be at least 18 years old to use The Perfect Mix app!")}function i(){var e=Alloy.createController("terms_and_conditions").getView();e.open({modal:!0})}function t(e){e.success?(Ti.API.info("FACEBOOK login success: "+e.toString()),Ti.App.Properties.setBool("over18",!0),Alloy.Globals.parent.open(),r.age_gate.close(),Alloy.Globals.fb.removeEventListener("login",t)):e.error?(Ti.API.info("FACEBOOK login error: "+e.toString()),Ti.UI.createAlertDialog({message:"ERROR: "+e.error,ok:"Ok",title:"Facebook"}).show()):e.cancelled?(Ti.API.info("FACEBOOK login cancel: "+e.toString()),alert("Cancelled")):0!=e.code?(Alloy.Globals.fb.forceDialogAuth=!0,Alloy.Globals.fb.authorize()):Ti.API.info("FACEBOOK return: "+e.toString())}function o(){Ti.API.info("FACEBOOK authorise, is it logged in: "+Alloy.Globals.fb.getLoggedIn()),Alloy.Globals.fb.getLoggedIn()?(Ti.App.Properties.setBool("over18",!0),Alloy.Globals.parent.open(),r.age_gate.close(),Alloy.Globals.fb.removeEventListener("login",t)):Alloy.Globals.fb.authorize()}function a(){r.picker_view.height="0dp",birthdate=p.getValue();var e=birthdate.getMonth(),i=birthdate.getDate(),t=birthdate.getFullYear();Ti.API.info("Month of birth value: "+e),r.month_birth.text=v[e],r.date_birth.text=i,r.year_birth.text=t;var o=Titanium.UI.createAnimation();o.top="0dp",o.duration=400,r.age_gate_view.animate(o)}function l(){var e=Titanium.UI.createAnimation();e.top="-78dp",e.duration=400,r.age_gate_view.animate(e),r.picker_view.height="300dp",r.picker_view.bottom=0,Ti.API.info("height after animation: "+r.picker_view.height+", bottom: "+r.picker_view.bottom)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="age_gate",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var r=this,d={},n={};r.__views.age_gate=Ti.UI.createWindow({backgroundColor:"white",titleAttributes:{color:Alloy.Globals.PrimaryColor,font:{fontFamily:Alloy.Globals.MainFont,fontSize:"18dp"}},barColor:"#fff",layout:"vertical",height:"568dp",width:"320dp",navBarHidden:!0,orientationModes:[Ti.UI.PORTRAIT,Ti.UI.UPSIDE_PORTRAIT],tintColor:Alloy.Globals.PrimaryColor,navTintColor:Alloy.Globals.PrimaryColor,id:"age_gate"}),r.__views.age_gate&&r.addTopLevelView(r.__views.age_gate),r.__views.age_gate_view=Ti.UI.createScrollView({top:"0dp",layout:"vertical",bottom:"0dp",width:Ti.UI.FILL,height:Ti.UI.FILL,contentWidth:"auto",contentHeight:Ti.UI.SIZE,disableBounce:!0,showVerticalScrollIndicator:!0,showHorizontalScrollIndicator:!1,backgroundColor:"#efefef",id:"age_gate_view"}),r.__views.age_gate.add(r.__views.age_gate_view),r.__views.__alloyId0=Ti.UI.createView({layout:"vertical",top:"0dp",height:Ti.UI.SIZE,id:"__alloyId0"}),r.__views.age_gate_view.add(r.__views.__alloyId0),r.__views.banner_img=Ti.UI.createImageView({top:"40dp",height:"102dp",width:"320dp",bottom:"40dp",id:"banner_img",image:"./images/age_gate/age_gate_banner.png"}),r.__views.__alloyId0.add(r.__views.banner_img),r.__views.__alloyId1=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:Alloy.Globals.PrimaryColor,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:"16dp",fontFamily:Alloy.Globals.BoldFont},text:"TO DISCOVER THE PERFECT MIX \nWE FIRST NEED TO CHECK YOUR AGE",id:"__alloyId1"}),r.__views.__alloyId0.add(r.__views.__alloyId1),r.__views.__alloyId4=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:Alloy.Globals.PrimaryColor,textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:"16dp",fontFamily:Alloy.Globals.BoldFont},top:"10dp",text:"ENTER YOUR DOB",id:"__alloyId4"}),r.__views.__alloyId0.add(r.__views.__alloyId4),r.__views.dob_picker=Ti.UI.createView({height:Ti.UI.SIZE,layout:"horizontal",top:"10dp",width:Ti.UI.SIZE,id:"dob_picker"}),r.__views.__alloyId0.add(r.__views.dob_picker),r.__views.day_picker=Ti.UI.createPicker({backgroundColor:"#898989",left:"8dp",right:"8dp",height:"120dp",borderRadius:8,bottom:"10dp",top:"0dp",width:"85dp",id:"day_picker",type:Ti.UI.PICKER_TYPE_PLAIN}),r.__views.dob_picker.add(r.__views.day_picker),r.__views.month_picker=Ti.UI.createPicker({backgroundColor:"#898989",left:"8dp",right:"8dp",height:"120dp",borderRadius:8,bottom:"10dp",top:"0dp",width:"85dp",id:"month_picker",type:Ti.UI.PICKER_TYPE_PLAIN}),r.__views.dob_picker.add(r.__views.month_picker),r.__views.year_picker=Ti.UI.createPicker({backgroundColor:"#898989",left:"8dp",right:"8dp",height:"120dp",borderRadius:8,bottom:"10dp",top:"0dp",width:"85dp",id:"year_picker",type:Ti.UI.PICKER_TYPE_PLAIN}),r.__views.dob_picker.add(r.__views.year_picker),r.__views.submitBtn=Ti.UI.createButton({width:"160dp",height:"32dp",top:"8dp",color:"#fff",backgroundColor:Alloy.Globals.PrimaryColor,borderRadius:4,font:{fontSize:"18dp",fontFamily:Alloy.Globals.MainFont},id:"submitBtn",title:"Submit"}),r.__views.__alloyId0.add(r.__views.submitBtn),e?r.__views.submitBtn.addEventListener("click",e):n["$.__views.submitBtn!click!submitBtnHandler"]=!0,r.__views.TandC_View=Ti.UI.createView({top:"10dp",height:Ti.UI.SIZE,width:Ti.UI.SIZE,layout:"vertical",id:"TandC_View"}),r.__views.__alloyId0.add(r.__views.TandC_View),r.__views.__alloyId8=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#898989",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:"13dp",fontFamily:Alloy.Globals.MainFont},text:"By entering the app you agree to our",id:"__alloyId8"}),r.__views.TandC_View.add(r.__views.__alloyId8),r.__views.__alloyId9=Ti.UI.createView({width:"110dp",height:Ti.UI.SIZE,id:"__alloyId9"}),r.__views.TandC_View.add(r.__views.__alloyId9),i?r.__views.__alloyId9.addEventListener("click",i):n["$.__views.__alloyId9!click!TandCBtnHandler"]=!0,r.__views.__alloyId10=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"#898989",textAlign:Ti.UI.TEXT_ALIGNMENT_CENTER,font:{fontSize:"13dp",fontFamily:Alloy.Globals.MainFont},text:"terms & conditions",id:"__alloyId10"}),r.__views.__alloyId9.add(r.__views.__alloyId10),r.__views.__alloyId11=Ti.UI.createView({height:"1dp",backgroundColor:"#898989",bottom:"1",id:"__alloyId11"}),r.__views.__alloyId9.add(r.__views.__alloyId11),r.__views.drinkaware_img=Ti.UI.createImageView({height:"55dp",width:Ti.UI.SIZE,id:"drinkaware_img",image:"./images/age_gate/drinkaware.png",top:"5dp"}),r.__views.age_gate_view.add(r.__views.drinkaware_img),d.destroy=function(){},_.extend(r,r.__views);for(var s,c,g,w,c,I,c,p,s=[],c=1;32>c;c++)s.push(Ti.UI.createPickerRow({title:c}));r.day_picker.add(s);for(var g=[],w=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),c=0;12>c;c++)g.push(Ti.UI.createPickerRow({title:w[c],value:c}));r.month_picker.add(g);for(var I=[],c=1900;(new Date).getFullYear()>=c;c++)I.push(Ti.UI.createPickerRow({title:c}));r.year_picker.add(I),r.year_picker.setSelectedRow(0,r.year_picker.getColumns()[0].rowCount-1,!1),r.age_gate.addEventListener("close",function(){Ti.API.info("age gate window closed")}),r.age_gate.addEventListener("open",function(){Ti.API.info("age gate window opened")});var v=["January","February","March","April","May","June","July","August","September","October","November","December"];n["$.__views.facebookBtn!click!facebookBtnHandler"]&&r.__views.facebookBtn.addEventListener("click",o),n["$.__views.facebookBtn!click!facebookBtnHandler"]&&r.__views.facebookBtn.addEventListener("click",o),n["$.__views.birth_date_dd!click!dateBtnHandler"]&&r.__views.birth_date_dd.addEventListener("click",l),n["$.__views.birth_month_dd!click!dateBtnHandler"]&&r.__views.birth_month_dd.addEventListener("click",l),n["$.__views.birth_year_dd!click!dateBtnHandler"]&&r.__views.birth_year_dd.addEventListener("click",l),n["$.__views.submitBtn!click!submitBtnHandler"]&&r.__views.submitBtn.addEventListener("click",e),n["$.__views.__alloyId9!click!TandCBtnHandler"]&&r.__views.__alloyId9.addEventListener("click",i),n["$.__views.picker_dob_submit!click!closeDateHandler"]&&r.__views.picker_dob_submit.addEventListener("click",a),_.extend(r,d)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;
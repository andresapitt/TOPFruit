define(function(){var t={},n=[];return{dynamic:!0,normalize:function(t,n){var e=t.split("!"),l=e[0];return e.shift(),(/^\./.test(l)?n(l):l)+(e.length?"!"+e.join("!"):"")},load:function(e,l,a){var i,o,r,s,u=e.split("!"),h=u.length;if((s=h>1&&"sandbox"===u[0])&&(u.shift(),e=u.join("!")),r=l.toUrl(/^\//.test(e)?e:"./"+e,n.length?{name:n[n.length-1]}:null),i=t[r]||l.cache(r),!i){if(o=new XMLHttpRequest,o.open("GET",r,!1),o.send(null),200!==o.status)throw new Error('Failed to load include "'+r+'": '+o.status);i=o.responseText}n.push(r);try{l.evaluate(t[r]=i,0,!s)}catch(c){throw c}finally{n.pop()}a(i)}}});